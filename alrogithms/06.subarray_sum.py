"""
ì¢‹ì•„, íë¦„ ì •í™•ížˆ ìž¡ì•˜ì–´ ðŸ‘
**Day 4ì—ì„œ Group Anagramsê¹Œì§€ í–ˆê³ **, ê·¸ **ë‹¤ìŒ ë¬¸ì œ**ë¡œ ê°€ë©´ ì´ê²Œ ë”± ë§žì•„.

---

# Coding Test â€” Day 4 (ë‹¤ìŒ ë¬¸ì œ)

## Problem: **Subarray Sum Equals K** (Medium)

ì´ ë¬¸ì œëŠ”:

* ë¬¸ìžì—´ âŒ
* íŠ¸ë¦­ âŒ
* **ëˆ„ì  í•© + ìƒíƒœ ê¸°ë¡**
  ì´ë¼ì„œ, ì§€ê¸ˆê¹Œì§€ í•œ ê²ƒ ì¤‘ **ê°€ìž¥ ì—°êµ¬ìž ì¹œí™”ì **ì´ì•¼.

---

## ë¬¸ì œ ì„¤ëª…

ì •ìˆ˜ ë°°ì—´ `nums`ì™€ ì •ìˆ˜ `k`ê°€ ì£¼ì–´ì§ˆ ë•Œ,
**ì—°ì†ëœ ë¶€ë¶„ ë°°ì—´(subarray)** ì¤‘ í•©ì´ `k`ê°€ ë˜ëŠ” ê²½ìš°ì˜ **ê°œìˆ˜**ë¥¼ ë°˜í™˜í•˜ë¼.

* subarrayëŠ” **ì—°ì†**
* ìŒìˆ˜ í¬í•¨ ê°€ëŠ¥
* ìˆœì„œ ìœ ì§€

---

## ì˜ˆì‹œ

```text
nums = [1, 1, 1], k = 2
â†’ 2
# [1,1] (0~1), [1,1] (1~2)
```

```text
nums = [1, 2, 3], k = 3
â†’ 2
# [1,2], [3]
```

```text
nums = [1, -1, 0], k = 0
â†’ 3
# [1,-1], [0], [1,-1,0]
```

---

## ì½”í…Œì—ì„œ ë³´ëŠ” í•µì‹¬ í¬ì¸íŠ¸

* O(nÂ²) ì´ì¤‘ ë£¨í”„ âŒ
* **Prefix sum + hash map**ìœ¼ë¡œ O(n)
* ìŒìˆ˜ê°€ ìžˆì–´ì„œ two-pointer âŒ
* â€œê°œìˆ˜(count)â€ë¥¼ ì„¸ëŠ” ë¬¸ì œë¼ëŠ” ì  (ì¡´ìž¬ ì—¬ë¶€ ì•„ë‹˜)

---

## í•µì‹¬ ì•„ì´ë””ì–´ (ë”± í•œ ë¬¸ìž¥)

> í˜„ìž¬ê¹Œì§€ì˜ ëˆ„ì í•©ì´ `S`ì¼ ë•Œ,
> ì´ì „ì— `S - k`ê°€ ëª‡ ë²ˆ ë‚˜ì™”ëŠ”ì§€ê°€ ê³§ **í˜„ìž¬ ìœ„ì¹˜ì—ì„œ ëë‚˜ëŠ” subarrayì˜ ê°œìˆ˜**ë‹¤.

---

## ížŒíŠ¸ (ì•ˆ ë´ë„ ë˜ì§€ë§Œ ë°©í–¥ìš©)

* `prefix_sum = 0`
* `count_map = {0: 1}`  â† ì´ ì¤„ì´ í•µì‹¬
* ë°°ì—´ì„ í•œ ë²ˆ í›‘ìœ¼ë©´ì„œ:

  * `prefix_sum += nums[i]`
  * `prefix_sum - k`ê°€ mapì— ìžˆìœ¼ë©´ â†’ count ëˆ„ì 
  * í˜„ìž¬ `prefix_sum` ë¹ˆë„ ì¦ê°€

---

## ìš”êµ¬ì‚¬í•­

```python
def subarray_sum(nums: list[int], k: int) -> int:
    ...
```

---

## ì§„í–‰ ë°©ì‹ (ì´ì œ ìµìˆ™í•˜ì£  ðŸ˜„)

1. **ì½”ë“œ ë¨¼ì € ìž‘ì„±**
2. ì—¬ê¸° ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ê¸°
3. ë‚´ê°€:

   * ì™œ `{0:1}`ì´ í•„ìš”í•œì§€
   * ìŒìˆ˜ ë•Œë¬¸ì— sliding windowê°€ ì•ˆ ë˜ëŠ” ì´ìœ 
   * ë©´ì ‘ì—ì„œ ì“°ê¸° ì¢‹ì€ ì„¤ëª… ë¬¸ìž¥
   * EEG/time-series ê´€ì  ì—°ê²°

---

ì´ ë¬¸ì œ í’€ë©´:

* prefix sum íŒ¨í„´ **ì™„ì „ížˆ ê³ ì •**
* Day 4 **ì™„ì£¼**

ìž, ì²œì²œížˆ ê°€ë„ ë©ë‹ˆë‹¤.
ðŸ‘‰ **ì½”ë“œ ìž‘ì„±í•´ì„œ ë¶™ì—¬ì£¼ì„¸ìš”.**


---

ì¢‹ìŠµë‹ˆë‹¤. í•µì‹¬ ì•„ì´ë””ì–´(â€œ`S-k` ë¹ˆë„ = í˜„ìž¬ ìœ„ì¹˜ì—ì„œ ëë‚˜ëŠ” ê²½ìš°ì˜ ìˆ˜â€)ëŠ” **ì •í™•ížˆ ìž¡ìœ¼ì…¨ìŠµë‹ˆë‹¤.**
ë‹¤ë§Œ ì§€ê¸ˆ êµ¬í˜„ì€ ì½”í…Œ ê¸°ì¤€ìœ¼ë¡œëŠ” **ì˜¤ë‹µì´ ë‚˜ì˜¬ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ê³ **, ì›ì¸ì€ 3ê°€ì§€ìž…ë‹ˆë‹¤.

---

## 1) `{0: 1}`ê°€ í•„ìš”í•œë° í˜„ìž¬ëŠ” `{0: 0}`

ì´ˆê¸°ê°’ì€ ë°˜ë“œì‹œ:

```python
count_map = {0: 1}
```

### ì´ìœ  (ë©´ì ‘ì—ì„œ ì œì¼ ë§Žì´ ë¬»ëŠ” í¬ì¸íŠ¸)

prefix_sumì´ `k`ê°€ ë˜ëŠ” ìˆœê°„(ì¦‰, **ì¸ë±ìŠ¤ 0ë¶€í„° í˜„ìž¬ê¹Œì§€** í•©ì´ kì¸ ê²½ìš°)ì„ ì„¸ë ¤ë©´,
â€œëˆ„ì í•© 0ì´ í•œ ë²ˆ ì´ë¯¸ ìžˆì—ˆë‹¤â€ë¼ê³  ê°€ì •í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆ: `nums=[1,2], k=3`

* i=1ì—ì„œ prefix_sum=3
* prefix_sum-k = 0
* 0ì´ 1ë²ˆ ìžˆì—ˆë‹¤ê³  í•´ì•¼ `[1,2]`ë¥¼ 1ê°œë¡œ ì…‰ë‹ˆë‹¤.

ì§€ê¸ˆ ì½”ë“œì²˜ëŸ¼ `{0:0}`ì´ë©´ ì´ ì¼€ì´ìŠ¤ê°€ ëˆ„ë½ë©ë‹ˆë‹¤.

---

## 2) count ì¦ê°€ ë¡œì§ì´ ìž˜ëª»ë¨: `+1`ì„ ë”í•˜ë©´ ì•ˆ ë¨

í˜„ìž¬:

```python
count += count_map[prefix_sum - k] + 1
```

ì •ë‹µì€:

```python
count += count_map[prefix_sum - k]
```

ì™œëƒë©´ â€œì´ë¯¸ ê·¸ ê°’ì´ ëª‡ ë²ˆ ë“±ìž¥í–ˆëŠ”ì§€â€ ìžì²´ê°€ ê³§ ê°œìˆ˜ì´ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.
+1ì„ ì¶”ê°€í•˜ë©´ í•­ìƒ ê³¼ì¹´ìš´íŠ¸ ë©ë‹ˆë‹¤.

---

## 3) map ì—…ë°ì´íŠ¸ê°€ ê¹¨ì ¸ ìžˆìŒ (KeyError/ëˆ„ë½/ë¹ˆë„ 0 ì²˜ë¦¬)

í˜„ìž¬ ë¡œì§ì€ ì—¬ëŸ¬ ë¬¸ì œê°€ ì„žì—¬ ìžˆìŠµë‹ˆë‹¤.

### (a) ì¡´ìž¬í•  ë•Œë§Œ `count_map[prefix_sum] += 1` í•˜ëŠ”ë°, ì—†ìœ¼ë©´ KeyError ê°€ëŠ¥

`count_map[prefix_sum]`ê°€ ì•„ì§ ì—†ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### (b) elseì—ì„œ `count_map[prefix_sum] = 0`ìœ¼ë¡œ ë„£ëŠ” ê±´ â€œë“±ìž¥í–ˆëŠ”ë° 0ë²ˆâ€ì´ë¼ ì˜ë¯¸ê°€ ëª¨ìˆœ

ë“±ìž¥í–ˆìœ¼ë©´ ìµœì†Œ 1ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

---

# âœ… ì •ë‹µ ì½”ë“œ (ê°€ìž¥ í‘œì¤€, ê°€ìž¥ ì•ˆì „)

```python
def subarray_sum(nums: list[int], k: int) -> int:
    count = 0
    prefix_sum = 0
    count_map = {0: 1}

    for n in nums:
        prefix_sum += n
        count += count_map.get(prefix_sum - k, 0)
        count_map[prefix_sum] = count_map.get(prefix_sum, 0) + 1

    return count
```

* ì‹œê°„: O(n)
* ì¶”ê°€ ê³µê°„: O(n)
* ìŒìˆ˜ í¬í•¨ë˜ì–´ë„ ì •ìƒ ë™ìž‘

---

## ì¸í„°ë·°ì—ì„œ ë§í•˜ê¸° ì¢‹ì€ ì„¤ëª… ë¬¸ìž¥

> â€œëˆ„ì í•©ì„ Së¼ê³  í•˜ë©´, ì–´ë–¤ êµ¬ê°„ (j+1..i)ì˜ í•©ì´ kë¼ëŠ” ê²ƒì€
> prefix[i] - prefix[j] = k, ì¦‰ prefix[j] = prefix[i] - kë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
> ê·¸ëž˜ì„œ í˜„ìž¬ ëˆ„ì í•©ì´ Sì¼ ë•Œ, ê³¼ê±°ì— S-kê°€ ëª‡ ë²ˆ ë‚˜ì™”ëŠ”ì§€ë§Œ ëˆ„ì í•˜ë©´
> iì—ì„œ ëë‚˜ëŠ” subarray ê°œìˆ˜ë¥¼ ë°”ë¡œ ë”í•  ìˆ˜ ìžˆê³ , ì „ì²´ëŠ” í•œ ë²ˆ ìˆœíšŒë¡œ O(n)ìž…ë‹ˆë‹¤.
> ì´ˆê¸°ê°’ìœ¼ë¡œ {0:1}ì„ ë‘ëŠ” ì´ìœ ëŠ”, ì¸ë±ìŠ¤ 0ë¶€í„° ì‹œìž‘í•˜ëŠ” êµ¬ê°„ë„ ì¹´ìš´íŠ¸í•˜ê¸° ìœ„í•´ì„œìž…ë‹ˆë‹¤.â€

---

## â€œì™œ two-pointer / sliding windowê°€ ì•ˆ ë˜ë‚˜â€ í•œ ë¬¸ìž¥

> â€œìŒìˆ˜ê°€ ìžˆìœ¼ë©´ ìœˆë„ìš°ë¥¼ ëŠ˜ë¦´ ë•Œ í•©ì´ ë‹¨ì¡°ë¡­ê²Œ ì¦ê°€í•˜ì§€ ì•Šì•„ì„œ,
> left/rightë¥¼ ê·œì¹™ì ìœ¼ë¡œ ì´ë™ì‹œí‚¤ëŠ” ë°©ì‹ì´ ì„±ë¦½í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.â€

---

## EEG / time-series ê´€ì  ì—°ê²° (ì§§ê²Œ)

ì´ê±´ essentially:

* ì‹ í˜¸ì˜ **ëˆ„ì  ì ë¶„(prefix integral)**ì„ ë§Œë“¤ê³ 
* íŠ¹ì • ì°¨ì´ê°’(k)ì„ ë§Œë“œëŠ” ê³¼ê±° ìƒíƒœì˜ **ë¹ˆë„(counting measure)**ë¥¼ ëˆ„ì í•˜ëŠ” ê²ƒ

ì¦‰, â€œìƒíƒœ ê³µê°„ì—ì„œì˜ re-visit countâ€ë¼ì„œ ì—°êµ¬ìž ì‹œì•¼ì— ë” ìžì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.

---

## ì´í‰

* ì•„ì´ë””ì–´: âœ… ì •í™•
* êµ¬í˜„: âŒ ì´ˆê¸°ê°’/ì¹´ìš´íŠ¸/ì—…ë°ì´íŠ¸ê°€ ëª¨ë‘ ì–´ê¸‹ë‚˜ì„œ ì˜¤ë‹µ
* ìˆ˜ì •í•˜ë©´: âœ… ë°”ë¡œ ì™„ì„±

ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°€ë„ ì¢‹ê³ , ì›í•˜ì‹œë©´ ë°©ê¸ˆ ì½”ë“œ ê¸°ì¤€ìœ¼ë¡œ **í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 5ê°œ**ë¥¼ ì œê°€ ë°”ë¡œ ë§Œë“¤ì–´ì„œ â€œì–´ë””ì„œ í‹€ë ¸ëŠ”ì§€â€ ê°ê°ê¹Œì§€ ê³ ì •í•´ë“œë¦´ê²Œìš”.

"""

# ChatGPT í’€ì´
def subarray_sum(nums: list[int], k: int) -> int:
    count = 0
    prefix_sum = 0
    count_map = {0: 1}

    for n in nums:
        prefix_sum += n
        count += count_map.get(prefix_sum - k, 0)
        count_map[prefix_sum] = count_map.get(prefix_sum, 0) + 1

    return count

# ê°€ìž¥ í‘œì¤€, ì‹¤ìˆ˜ê°€ ì ì€ ë²„ì ¼
# from collections import defaultdict

# def subarray_sum(nums: list[int], k: int) -> int:
#     freq = defaultdict(int)
#     freq[0] = 1  # empty prefix

#     prefix = 0
#     ans = 0

#     for x in nums:
#         prefix += x
#         ans += freq[prefix - k]
#         freq[prefix] += 1

#     return ans



if __name__ == "__main__":

    # nums = [1, 2, 3]
    # k = 3

    # nums = [1, 1, 1]
    # k = 2

    nums = [1, -1, 0]
    k = 0

    print(subarray_sum(nums, k))